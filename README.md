# Сервис Обмен валюты
Приложение "Обмен Валюты"

Сервис предоставляет REST API для:
- хранения и получения информации о валютах;
- конвертации валют;
- автоматического обновления курсов валют из открытого источника ЦБ РФ.

## Функциональность

В рамках задания реализовано:

- хранение валют в базе данных PostgreSQL;
- расширение модели валюты полем **буквенный ISO-код (ISO Char Code)**;
- получение информации о валюте по `id`;
- получение списка всех доступных валют;
- конвертация валют по числовому ISO-коду;
- загрузка и обновление курсов валют из ЦБ РФ (XML);
- автоматическое обновление курсов **один раз в час**;
- логирование процесса обновления валют

Обновление курсов валют:
- Источник данных:
https://cbr.ru/scripts/XML_daily.asp
- Формат данных: XML
- Обновление происходит автоматически каждый час
- Обновление выполняется по стратегии:
  - обновление записи, если валюта с таким ISO Char Code уже существует;
  - создание новой записи, если валюта отсутствует в БД.

Информация об успешном обновлении отображается в логах приложения.

## Используемые технологии
- Java 17
- Spring Boot 2.7
- Spring Data JPA (Hibernate)
- Maven 3
- Lombok
- MapStruct
- Liquibase
- PostgreSQL
- JAXB
- Docker

## Требования

### JDK 17

Проект использует синтаксис Java 17. Для локального запуска вам потребуется
установленный JDK 17.

### Docker
Для запуска проекта вам потребуется установленный и запущенный Docker.
Для запуска БД(PostgreSQL) требуется запустить соответствующий сервис в Docker.

### Подключение к интернету

Подключение к интернету для получения курсов валют

## Полезные команды

### Запуск контейнера с базой данных

```bash
docker run -p 5432:5432 --name postgres -e POSTGRES_PASSWORD=postgres -d postgres
```

Пользователь для подключения к контейнеру `postgres`.

### IntelliJ IDEA

Запустите main метод класса 
```nginx
Application
```

### Запросы API

Создание новой записи о валюте

```bash
curl --request POST \
  --url http://localhost:8080/api/currency/create \
  --header 'Content-Type: application/json' \
  --data '{
  "name": "Доллар Готэм-Сити",
  "nominal": 3,
  "value": 32.2,
  "isoNumCode": 1337
}'
```

Получение списка всех валют

```bash
curl --request GET \
  --url http://localhost:8080/api/currency
```

Получение Валюты по id

```bash
curl --request GET \
  --url http://localhost:8080/api/currency/1333
```

Конвертация валюты по числовому коду

```bash
curl --request GET \
--url http://localhost:8080/api/currency/convert?value=100&numCode=840
```